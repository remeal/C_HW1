#env:
#    - TARGET_CPU=amd64 BUILD_CONFIGURATION=Debug
#    - TARGET_CPU=amd64 BUILD_CONFIGURATION=Release
#    - TARGET_CPU=x86 BUILD_CONFIGURATION=Debug
#    - TARGET_CPU=x86 BUILD_CONFIGURATION=Release

#matrix:
#    exclude:
#        - os:       linux
#          compiler: gcc

#install:
#    # скрипт настройки среды и установки зависимостей:
#    - source ci/travis/install-$TRAVIS_OS_NAME.sh

#script:
#    # скрипт сборки и тестирования проекта:
#    - mkdir build
#    - cd build
#    - cmake .. -DCMAKE_BUILD_TYPE=$BUILD_CONFIGURATION -DTARGET_CPU=$TARGET_CPU
#    - cmake --build .
#    - ctest --output-on-failure


dist: trusty
sudo: required

language: c

os:
    - linux

compiler:
    - gcc

addons:
    apt:
        packages:
            - valgrind
            - cppcheck
            - cmake
            - clang
before_scripts:
    - sudo pip install cpplint
    - cmake -DCMAKE_BUILD_TYPE=Debug -DWRAP_VALGRIND=ON .
script:
    - ctest --output-on-failure
    - cd "${TRAVIS_BUILD_DIR}"
    - cppcheck --std=c99 --enable=all -inconclusive src/*.c
    - cppcheck --std=c++11 --enable=all -inconclusive test/*.cpp
    - cpplint --filter=-legal/copyright,-readability/casting test/*.cpp
    - cpplint --filter=-legal/copyright,-readability/casting include/*.h
    - cmake .
    - make
after_success:
    - cd "${TRAVIS_BUILD_DIR}"
    #- valgrind  --show-leak-kinds=all --track-origins=yes --leak-check=full ./main.out
    - bash <(curl -s https://codecov.io/bash) -X gcovout